<div class="section" id="vscode" data-tags="vscode">
  <h2>Snippets VS Code</h2>

  <!-- Categoria: Formulários -->
  <div class="section" id="formularios" data-tags="categoria formularios php adianti">
    <h3>
      <i class="fa-solid fa-file-code"></i> Formulários
      <i class="fa-solid fa-chevron-down collapse-icon" data-target="formularios-snippets"></i>
    </h3>
    <div class="category-controls">
      <button class="expand-all" data-target="bancos-de-dados-snippets">
        <i class="fa-solid fa-expand"></i>
        <strong>Mostrar todos</strong>
      </button>
      <button class="collapse-all" data-target="bancos-de-dados-snippets" style="display:none;">
        <i class="fa-solid fa-compress"></i>
        <strong>Ocultar todos</strong>
      </button>
    </div>
    <div id="formularios-snippets">
<!-- INÍCIO SNIPPET: Formulário Adianti simples -->
<div class="snippet-block" data-tags="adianti php form formulario simples">
  <div class="snippet-title">
    <i class="fa-solid fa-plus"></i>
    <strong>Formulário Adianti simples:</strong>
    <a class="download-btn" href="snippets_madbuilder/adianti_form_simples.code-snippets" download title="Baixar snippet">
      <i class="fa fa-download"></i>
    </a>
  </div>
  <div class="snippet-content">
    <pre><code class="language-json">{
  "Formulário simples Adianti": {
    "prefix": "adianti_form_simples",
    "body": [
      "class FuncionarioForm extends TPage {",
      "    protected \\$form;",
      "    private \\$formFields = [];",
      "    private static \\$database = 'exemplos';",
      "    private static \\$activeRecord = 'Funcionario';",
      "    private static \\$primaryKey = 'id';",
      "    private static \\$formName = 'form_Funcionario';",
      "",
      "    /**",
      "     * Form constructor",
      "     * @param \\$param Request",
      "     */",
      "    public function __construct(\\$param) {",
      "        parent::__construct();",
      "",
      "        if(!empty(\\$param['target_container'])) {",
      "            \\$this->adianti_target_container = \\$param['target_container'];",
      "        }",
      "",
      "        // creates the form",
      "        \\$this->form = new BootstrapFormBuilder(self::\\$formName);",
      "        // define the form title",
      "        \\$this->form->setFormTitle(\"Cadastro de funcionário\");",
      "",
      "        \\$id = new TEntry('id');",
      "        \\$dt_nascimento = new TDate('dt_nascimento');",
      "        \\$nome = new TEntry('nome');",
      "        \\$sobrenome = new TEntry('sobrenome');",
      "        \\$funcao_id = new TDBCombo('funcao_id', 'exemplos', 'Funcao', 'id', '{nome}','nome asc');",
      "        \\$cidade_estado_pais_id = new TDBCombo('cidade_estado_pais_id', 'exemplos', 'Pais', 'id', '{nome}','nome asc');",
      "        \\$cidade_estado_id = new TCombo('cidade_estado_id');",
      "        \\$cidade_id = new TCombo('cidade_id');",
      "        \\$cep = new TEntry('cep');",
      "        \\$endereco = new TText('endereco');",
      "",
      "        \\$cidade_estado_pais_id->setChangeAction(new TAction([\\$this,'onChangecidade_estado_pais_id']));",
      "        \\$cidade_estado_id->setChangeAction(new TAction([\\$this,'onChangecidade_estado_id']));",
      "",
      "        \\$dt_nascimento->addValidation(\"Data de nascimento\", new TRequiredValidator());",
      "        \\$nome->addValidation(\"Nome\", new TRequiredValidator());",
      "        \\$sobrenome->addValidation(\"Sobrenome\", new TRequiredValidator());",
      "        \\$funcao_id->addValidation(\"Funcao id\", new TRequiredValidator());",
      "        \\$cidade_estado_pais_id->addValidation(\"País\", new TRequiredValidator());",
      "        \\$cidade_id->addValidation(\"Cidade\", new TRequiredValidator());",
      "",
      "        \\$id->setEditable(false);",
      "        \\$dt_nascimento->setMask('dd/mm/yyyy');",
      "        \\$dt_nascimento->setDatabaseMask('yyyy-mm-dd');",
      "        \\$id->setSize(100);",
      "        \\$cep->setSize('100%');",
      "        \\$nome->setSize('100%');",
      "        \\$sobrenome->setSize('100%');",
      "        \\$funcao_id->setSize('100%');",
      "        \\$cidade_id->setSize('100%');",
      "        \\$dt_nascimento->setSize(110);",
      "        \\$endereco->setSize('100%', 68);",
      "        \\$cidade_estado_id->setSize('100%');",
      "        \\$cidade_estado_pais_id->setSize('100%');",
      "",
      "        \\$nome->autofocus = 'autofocus';",
      "",
      "        \\$row1 = \\$this->form->addFields([new TLabel(\"Id:\", null, '14px', null)],[\\$id],[new TLabel(\"Data de nascimento:\", '#ff0000', '14px', null)],[\\$dt_nascimento]);",
      "        \\$row2 = \\$this->form->addFields([new TLabel(\"Nome:\", '#ff0000', '14px', null)],[\\$nome],[new TLabel(\"Sobrenome:\", '#ff0000', '14px', null)],[\\$sobrenome]);",
      "        \\$row3 = \\$this->form->addFields([new TLabel(\"Funcao:\", '#ff0000', '14px', null)],[\\$funcao_id],[],[]);",
      "        \\$row4 = \\$this->form->addContent([new TFormSeparator(\"Endereço\", '#333333', '18', '#eeeeee')]);",
      "        \\$row5 = \\$this->form->addFields([new TLabel(\"País:\", '#ff0000', '14px', null)],[\\$cidade_estado_pais_id],[new TLabel(\"Estado:\", '#ff0000', '14px', null)],[\\$cidade_estado_id]);",
      "        \\$row6 = \\$this->form->addFields([new TLabel(\"Cidade:\", '#ff0000', '14px', null)],[\\$cidade_id],[new TLabel(\"Cep:\", '#ff0000', '14px', null)],[\\$cep]);",
      "        \\$row7 = \\$this->form->addFields([new TLabel(\"Endereco:\", '#ff0000', '14px', null)],[\\$endereco]);",
      "",
      "        // create the form actions",
      "        \\$btn_onsave = \\$this->form->addAction(\"Salvar\", new TAction([\\$this, 'onSave']), 'far:save #ffffff');",
      "        \\$this->btn_onsave = \\$btn_onsave;",
      "        \\$btn_onsave->addStyleClass('btn-primary');",
      "",
      "        \\$btn_onclear = \\$this->form->addAction(\"Limpar formulário\", new TAction([\\$this, 'onClear']), 'fas:eraser #dd5a43');",
      "        \\$this->btn_onclear = \\$btn_onclear;",
      "",
      "        // vertical box container",
      "        \\$container = new TVBox;",
      "        \\$container->style = 'width: 100%';",
      "        \\$container->class = 'form-container';",
      "        if(empty(\\$param['target_container'])) {",
      "            // \\$container->add(new TXMLBreadCrumb('menu.xml', __CLASS__));",
      "        }",
      "        \\$container->add(\\$this->form);",
      "",
      "        parent::add(\\$container);",
      "    }",
      "",
      "    public static function onChangecidade_estado_pais_id(\\$param) {",
      "        try {",
      "            if (isset(\\$param['cidade_estado_pais_id']) && \\$param['cidade_estado_pais_id']) {",
      "                \\$criteria = TCriteria::create(['pais_id' => \\$param['cidade_estado_pais_id']]);",
      "                TDBCombo::reloadFromModel(self::\\$formName, 'cidade_estado_id', 'exemplos', 'Estado', 'id', '{nome}', 'nome asc', \\$criteria, TRUE);",
      "            }",
      "            else {",
      "                TCombo::clearField(self::\\$formName, 'cidade_estado_id');",
      "            }",
      "        }",
      "        catch (Exception \\$e) {",
      "            new TMessage('error', \\$e->getMessage());",
      "        }",
      "    }",
      "",
      "    public static function onChangecidade_estado_id(\\$param) {",
      "        try {",
      "            if (isset(\\$param['cidade_estado_id']) && \\$param['cidade_estado_id']) {",
      "                \\$criteria = TCriteria::create(['estado_id' => \\$param['cidade_estado_id']]);",
      "                TDBCombo::reloadFromModel(self::\\$formName, 'cidade_id', 'exemplos', 'Cidade', 'id', '{nome}', 'nome asc', \\$criteria, TRUE);",
      "            }",
      "            else {",
      "                TCombo::clearField(self::\\$formName, 'cidade_id');",
      "            }",
      "        }",
      "        catch (Exception \\$e) {",
      "            new TMessage('error', \\$e->getMessage());",
      "        }",
      "    }",
      "",
      "    public function onSave(\\$param = null) {",
      "        try {",
      "            TTransaction::open(self::\\$database); // open a transaction",
      "",
      "            /**",
      "            // Enable Debug logger for SQL operations inside the transaction",
      "            TTransaction::setLogger(new TLoggerSTD); // standard output",
      "            TTransaction::setLogger(new TLoggerTXT('log.txt')); // file",
      "            **/",
      "",
      "            \\$messageAction = null;",
      "",
      "            \\$this->form->validate(); // validate form data",
      "",
      "            \\$object = new Funcionario(); // create an empty object",
      "",
      "            \\$data = \\$this->form->getData(); // get form data as array",
      "            \\$object->fromArray((array) \\$data); // load the object with data",
      "",
      "            \\$object->store(); // save the object",
      "",
      "            \\$this->fireEvents(\\$object);",
      "",
      "            // get the generated {PRIMARY_KEY}",
      "            \\$data->id = \\$object->id;",
      "",
      "            \\$this->form->setData(\\$data); // fill form data",
      "            TTransaction::close(); // close the transaction",
      "",
      "            /**",
      "            // To define an action to be executed on the message close event:",
      "            \\$messageAction = new TAction(['className', 'methodName']);",
      "            **/",
      "",
      "            new TMessage('info', AdiantiCoreTranslator::translate('Record saved'), \\$messageAction);",
      "        }",
      "        catch (Exception \\$e) { // in case of exception",
      "            new TMessage('error', \\$e->getMessage()); // shows the exception error message",
      "            \\$this->form->setData(\\$this->form->getData()); // keep form data",
      "            TTransaction::rollback(); // undo all pending operations",
      "        }",
      "    }",
      "",
      "    public function onEdit(\\$param) {",
      "        try {",
      "            if (isset(\\$param['key'])) {",
      "                \\$key = \\$param['key'];  // get the parameter \\$key",
      "                TTransaction::open(self::\\$database); // open a transaction",
      "",
      "                \\$object = new Funcionario(\\$key); // instantiates the Active Record",
      "",
      "                \\$object->cidade_estado_pais_id = \\$object->cidade->estado->pais->id;",
      "                \\$object->cidade_estado_id = \\$object->cidade->estado->id;",
      "",
      "                \\$this->form->setData(\\$object); // fill the form",
      "",
      "                \\$this->fireEvents(\\$object);",
      "",
      "                TTransaction::close(); // close the transaction",
      "            }",
      "            else {",
      "                \\$this->form->clear();",
      "            }",
      "        }",
      "        catch (Exception \\$e) { // in case of exception",
      "            new TMessage('error', \\$e->getMessage()); // shows the exception error message",
      "            TTransaction::rollback(); // undo all pending operations",
      "        }",
      "    }",
      "",
      "    /**",
      "     * Clear form data",
      "     * @param \\$param Request",
      "     */",
      "    public function onClear(\\$param) {",
      "        \\$this->form->clear(true);",
      "    }",
      "",
      "    public function onShow(\\$param = null) {",
      "",
      "    }",
      "",
      "    public function fireEvents(\\$object) {",
      "        \\$obj = new stdClass;",
      "        if(is_object(\\$object) && get_class(\\$object) == 'stdClass') {",
      "            if(isset(\\$object->cidade_estado_pais_id)) {",
      "                \\$value = \\$object->cidade_estado_pais_id;",
      "                \\$obj->cidade_estado_pais_id = \\$value;",
      "            }",
      "            if(isset(\\$object->cidade_estado_id)) {",
      "                \\$value = \\$object->cidade_estado_id;",
      "                \\$obj->cidade_estado_id = \\$value;",
      "            }",
      "            if(isset(\\$object->cidade_id)) {",
      "                \\$value = \\$object->cidade_id;",
      "                \\$obj->cidade_id = \\$value;",
      "            }",
      "        }",
      "        elseif(is_object(\\$object)) {",
      "            if(isset(\\$object->cidade->estado->pais->id)) {",
      "                \\$value = \\$object->cidade->estado->pais->id;",
      "                \\$obj->cidade_estado_pais_id = \\$value;",
      "            }",
      "            if(isset(\\$object->cidade->estado->id)) {",
      "                \\$value = \\$object->cidade->estado->id;",
      "                \\$obj->cidade_estado_id = \\$value;",
      "            }",
      "            if(isset(\\$object->cidade_id)) {",
      "                \\$value = \\$object->cidade_id;",
      "                \\$obj->cidade_id = \\$value;",
      "            }",
      "        }",
      "        TForm::sendData(self::\\$formName, \\$obj);",
      "    }",
      "}"
    ],
    "description": "Formulário simples Adianti",
    "link": "https://www.madbuilder.com.br/exemplo-formulario-simples"
  }
}
</code></pre>
  </div>
</div>
<!-- FIM SNIPPET -->

<!-- INÍCIO SNIPPET -->
<div class="snippet-block" data-tags="adianti php form formulario rotulo acima">
  <div class="snippet-title">
    <i class="fa-solid fa-plus"></i>
    <strong>Formulário (rótulo acima) Adianti:</strong>
    <a class="download-btn" href="snippets_vscode/adianti_form_rotulo_acima.code-snippets" download title="Baixar snippet">
      <i class="fa fa-download"></i>
    </a>
  </div>
  <div class="snippet-content">
    <pre><code class="language-json">{
  "Formulário (rótulo acima) Adianti": {
    "prefix": "adianti_form_rotulo_acima",
    "body": [
      "class FuncionarioFormRotulo extends TPage {",
      "    protected \\$form;",
      "    private \\$formFields = [];",
      "    private static \\$database = 'exemplos';",
      "    private static \\$activeRecord = 'Funcionario';",
      "    private static \\$primaryKey = 'id';",
      "    private static \\$formName = 'form_Funcionario';",
      "",
      "    /**",
      "     * Form constructor",
      "     * @param \\$param Request",
      "     */",
      "    public function __construct(\\$param) {",
      "        parent::__construct();",
      "",
      "        if(!empty(\\$param['target_container'])) {",
      "            \\$this->adianti_target_container = \\$param['target_container'];",
      "        }",
      "",
      "        // creates the form",
      "        \\$this->form = new BootstrapFormBuilder(self::\\$formName);",
      "        // define the form title",
      "        \\$this->form->setFormTitle(\"Fomulário simples (rótulo acima)\");",
      "",
      "        \\$id = new TEntry('id');",
      "        \\$dt_nascimento = new TDate('dt_nascimento');",
      "        \\$nome = new TEntry('nome');",
      "        \\$sobrenome = new TEntry('sobrenome');",
      "        \\$funcao_id = new TDBCombo('funcao_id', 'exemplos', 'Funcao', 'id', '{nome}','nome asc');",
      "        \\$cidade_estado_pais_id = new TDBCombo('cidade_estado_pais_id', 'exemplos', 'Pais', 'id', '{nome}','nome asc');",
      "        \\$cidade_estado_id = new TCombo('cidade_estado_id');",
      "        \\$cidade_id = new TCombo('cidade_id');",
      "        \\$cep = new TEntry('cep');",
      "        \\$endereco = new TText('endereco');",
      "",
      "        \\$cidade_estado_pais_id->setChangeAction(new TAction([\\$this,'onChangecidade_estado_pais_id']));",
      "        \\$cidade_estado_id->setChangeAction(new TAction([\\$this,'onChangecidade_estado_id']));",
      "",
      "        \\$dt_nascimento->addValidation(\"Data de nascimento\", new TRequiredValidator());",
      "        \\$nome->addValidation(\"Nome\", new TRequiredValidator());",
      "        \\$sobrenome->addValidation(\"Sobrenome\", new TRequiredValidator());",
      "        \\$funcao_id->addValidation(\"Funcao id\", new TRequiredValidator());",
      "        \\$cidade_id->addValidation(\"Cidade id\", new TRequiredValidator());",
      "",
      "        \\$id->setEditable(false);",
      "        \\$dt_nascimento->setMask('dd/mm/yyyy');",
      "        \\$dt_nascimento->setDatabaseMask('yyyy-mm-dd');",
      "        \\$id->setSize(100);",
      "        \\$cep->setSize('100%');",
      "        \\$nome->setSize('100%');",
      "        \\$sobrenome->setSize('100%');",
      "        \\$funcao_id->setSize('100%');",
      "        \\$cidade_id->setSize('100%');",
      "        \\$dt_nascimento->setSize(110);",
      "        \\$endereco->setSize('100%', 70);",
      "        \\$cidade_estado_id->setSize('100%');",
      "        \\$cidade_estado_pais_id->setSize('100%');",
      "",
      "        \\$row1 = \\$this->form->addFields([new TLabel(\"Id:\", null, '14px', 'B', '100%'),\\$id],[new TLabel(\"Data de nascimento:\", '#ec644b', '14px', 'B', '100%'),\\$dt_nascimento]);",
      "        \\$row1->layout = ['col-sm-6','col-sm-6'];",
      "",
      "        \\$row2 = \\$this->form->addFields([new TLabel(\"Nome:\", '#ec644b', '14px', 'B', '100%'),\\$nome],[new TLabel(\"Sobrenome:\", '#ec644b', '14px', 'B', '100%'),\\$sobrenome]);",
      "        \\$row2->layout = ['col-sm-6','col-sm-6'];",
      "",
      "        \\$row3 = \\$this->form->addFields([new TLabel(\"Função:\", '#ec644b', '14px', 'B', '100%'),\\$funcao_id],[]);",
      "        \\$row3->layout = ['col-sm-6','col-sm-6'];",
      "",
      "        \\$row4 = \\$this->form->addContent([new TFormSeparator(\"Endereço\", '#333333', '22', '#eeeeee')]);",
      "        \\$row5 = \\$this->form->addFields([new TLabel(\"País:\", '#ec644b', '14px', 'B', '100%'),\\$cidade_estado_pais_id],[new TLabel(\"Estado:\", '#ec644b', '14px', 'B', '100%'),\\$cidade_estado_id]);",
      "        \\$row5->layout = [' col-sm-6',' col-sm-6'];",
      "",
      "        \\$row6 = \\$this->form->addFields([new TLabel(\"Cidade:\", '#ec644b', '14px', 'B', '100%'),\\$cidade_id],[new TLabel(\"CEP:\", '#ec644b', '14px', 'B', '100%'),\\$cep]);",
      "        \\$row6->layout = ['col-sm-6','col-sm-6'];",
      "",
      "        \\$row7 = \\$this->form->addFields([new TLabel(\"Endereco:\", '#ec644b', '14px', 'B', '100%'),\\$endereco]);",
      "        \\$row7->layout = [' col-sm-12'];",
      "",
      "        // create the form actions",
      "        \\$btn_onsave = \\$this->form->addAction(\"Salvar\", new TAction([\\$this, 'onSave']), 'far:save #ffffff');",
      "        \\$this->btn_onsave = \\$btn_onsave;",
      "        \\$btn_onsave->addStyleClass('btn-primary');",
      "",
      "        \\$btn_onclear = \\$this->form->addAction(\"Limpar formulário\", new TAction([\\$this, 'onClear']), 'fas:eraser #dd5a43');",
      "        \\$this->btn_onclear = \\$btn_onclear;",
      "",
      "        // vertical box container",
      "        \\$container = new TVBox;",
      "        \\$container->style = 'width: 100%';",
      "        \\$container->class = 'form-container';",
      "        if(empty(\\$param['target_container'])) {",
      "            \\$container->add(TBreadCrumb::create([\"Formulários\",\"Fomulário simples (rótulo acima)\"]));",
      "        }",
      "        \\$container->add(\\$this->form);",
      "",
      "        parent::add(\\$container);",
      "    }",
      "",
      "    public static function onChangecidade_estado_pais_id(\\$param) {",
      "        try {",
      "            if (isset(\\$param['cidade_estado_pais_id']) && \\$param['cidade_estado_pais_id']) {",
      "                \\$criteria = TCriteria::create(['pais_id' => \\$param['cidade_estado_pais_id']]);",
      "                TDBCombo::reloadFromModel(self::\\$formName, 'cidade_estado_id', 'exemplos', 'Estado', 'id', '{nome}', 'nome asc', \\$criteria, TRUE);",
      "            }",
      "            else {",
      "                TCombo::clearField(self::\\$formName, 'cidade_estado_id');",
      "            }",
      "        }",
      "        catch (Exception \\$e) {",
      "            new TMessage('error', \\$e->getMessage());",
      "        }",
      "    }",
      "",
      "    public static function onChangecidade_estado_id(\\$param) {",
      "        try {",
      "            if (isset(\\$param['cidade_estado_id']) && \\$param['cidade_estado_id']) {",
      "                \\$criteria = TCriteria::create(['estado_id' => \\$param['cidade_estado_id']]);",
      "                TDBCombo::reloadFromModel(self::\\$formName, 'cidade_id', 'exemplos', 'Cidade', 'id', '{nome}', 'nome asc', \\$criteria, TRUE);",
      "            }",
      "            else {",
      "                TCombo::clearField(self::\\$formName, 'cidade_id');",
      "            }",
      "        }",
      "        catch (Exception \\$e) {",
      "            new TMessage('error', \\$e->getMessage());",
      "        }",
      "    }",
      "",
      "    public function onSave(\\$param = null) {",
      "        try {",
      "            TTransaction::open(self::\\$database); // open a transaction",
      "",
      "            /**",
      "            // Enable Debug logger for SQL operations inside the transaction",
      "            TTransaction::setLogger(new TLoggerSTD); // standard output",
      "            TTransaction::setLogger(new TLoggerTXT('log.txt')); // file",
      "            **/",
      "",
      "            \\$messageAction = null;",
      "",
      "            \\$this->form->validate(); // validate form data",
      "",
      "            \\$object = new Funcionario(); // create an empty object",
      "",
      "            \\$data = \\$this->form->getData(); // get form data as array",
      "            \\$object->fromArray((array) \\$data); // load the object with data",
      "",
      "            \\$object->store(); // save the object",
      "",
      "            \\$this->fireEvents(\\$object);",
      "",
      "            // get the generated {PRIMARY_KEY}",
      "            \\$data->id = \\$object->id;",
      "",
      "            \\$this->form->setData(\\$data); // fill form data",
      "            TTransaction::close(); // close the transaction",
      "",
      "            /**",
      "            // To define an action to be executed on the message close event:",
      "            \\$messageAction = new TAction(['className', 'methodName']);",
      "            **/",
      "",
      "            new TMessage('info', AdiantiCoreTranslator::translate('Record saved'), \\$messageAction);",
      "        }",
      "        catch (Exception \\$e) { // in case of exception",
      "            new TMessage('error', \\$e->getMessage()); // shows the exception error message",
      "            \\$this->form->setData(\\$this->form->getData()); // keep form data",
      "            TTransaction::rollback(); // undo all pending operations",
      "        }",
      "    }",
      "",
      "    public function onEdit(\\$param) {",
      "        try {",
      "            if (isset(\\$param['key'])) {",
      "                \\$key = \\$param['key'];  // get the parameter \\$key",
      "                TTransaction::open(self::\\$database); // open a transaction",
      "",
      "                \\$object = new Funcionario(\\$key); // instantiates the Active Record",
      "",
      "                \\$object->cidade_estado_pais_id = \\$object->cidade->estado->pais->id;",
      "                \\$object->cidade_estado_id = \\$object->cidade->estado->id;",
      "",
      "                \\$this->form->setData(\\$object); // fill the form",
      "",
      "                \\$this->fireEvents(\\$object);",
      "",
      "                TTransaction::close(); // close the transaction",
      "            }",
      "            else {",
      "                \\$this->form->clear();",
      "            }",
      "        }",
      "        catch (Exception \\$e) { // in case of exception",
      "            new TMessage('error', \\$e->getMessage()); // shows the exception error message",
      "            TTransaction::rollback(); // undo all pending operations",
      "        }",
      "    }",
      "",
      "    /**",
      "     * Clear form data",
      "     * @param \\$param Request",
      "     */",
      "    public function onClear(\\$param) {",
      "        \\$this->form->clear(true);",
      "    }",
      "",
      "    public function onShow(\\$param = null) {",
      "",
      "    }",
      "",
      "    public function fireEvents(\\$object) {",
      "        \\$obj = new stdClass;",
      "        if(is_object(\\$object) && get_class(\\$object) == 'stdClass') {",
      "            if(isset(\\$object->cidade_estado_pais_id)) {",
      "                \\$value = \\$object->cidade_estado_pais_id;",
      "                \\$obj->cidade_estado_pais_id = \\$value;",
      "            }",
      "            if(isset(\\$object->cidade_estado_id)) {",
      "                \\$value = \\$object->cidade_estado_id;",
      "                \\$obj->cidade_estado_id = \\$value;",
      "            }",
      "            if(isset(\\$object->cidade_id)) {",
      "                \\$value = \\$object->cidade_id;",
      "                \\$obj->cidade_id = \\$value;",
      "            }",
      "        }",
      "        elseif(is_object(\\$object)) {",
      "            if(isset(\\$object->cidade->estado->pais->id)) {",
      "                \\$value = \\$object->cidade->estado->pais->id;",
      "                \\$obj->cidade_estado_pais_id = \\$value;",
      "            }",
      "            if(isset(\\$object->cidade->estado->id)) {",
      "                \\$value = \\$object->cidade->estado->id;",
      "                \\$obj->cidade_estado_id = \\$value;",
      "            }",
      "            if(isset(\\$object->cidade_id)) {",
      "                \\$value = \\$object->cidade_id;",
      "                \\$obj->cidade_id = \\$value;",
      "            }",
      "        }",
      "        TForm::sendData(self::\\$formName, \\$obj);",
      "    }",
      "}"
    ],
    "description": "Formulário Adianti com rótulos acima dos campos",
    "link": "https://www.madbuilder.com.br/exemplo-formulario-simples-rotulo-acima"
  }
}
</code></pre>
  </div>
</div>
<!-- FIM SNIPPET -->

<!-- INÍCIO SNIPPET -->
      <div class="snippet-block" data-tags="adianti php form formulario abas">
        <div class="snippet-title">
          <i class="fa-solid fa-plus"></i>
          <strong>Formulário Adianti com abas:</strong>
          <a class="download-btn" href="snippets_vscode/adianti_form_com_abas.code-snippets" download title="Baixar snippet">
            <i class="fa fa-download"></i>
          </a>
        </div>
        <div class="snippet-content">
          <pre><code class="language-json">{
  "Formulário Adianti com abas": {
    "prefix": "adianti_form_abas",
    "body": [
      "class FuncionarioAbasForm extends TPage {",
      "    protected \\$form;",
      "    private \\$formFields = [];",
      "    private static \\$database = 'exemplos';",
      "    private static \\$activeRecord = 'Funcionario';",
      "    private static \\$primaryKey = 'id';",
      "    private static \\$formName = 'form_Funcionario';",
      "",
      "    /**",
      "     * Form constructor",
      "     * @param \\$param Request",
      "     */",
      "    public function __construct(\\$param) {",
      "        parent::__construct();",
      "",
      "        if(!empty(\\$param['target_container'])) {",
      "            \\$this->adianti_target_container = \\$param['target_container'];",
      "        }",
      "",
      "        // creates the form",
      "        \\$this->form = new BootstrapFormBuilder(self::\\$formName);",
      "        // define the form title",
      "        \\$this->form->setFormTitle(\"Formulário com abas\");",
      "",
      "        \\$id = new TEntry('id');",
      "        \\$dt_nascimento = new TDate('dt_nascimento');",
      "        \\$nome = new TEntry('nome');",
      "        \\$sobrenome = new TEntry('sobrenome');",
      "        \\$cidade_estado_pais_id = new TDBCombo('cidade_estado_pais_id', 'exemplos', 'Pais', 'id', '{nome}','nome asc');",
      "        \\$cidade_estado_id = new TCombo('cidade_estado_id');",
      "        \\$cidade_id = new TCombo('cidade_id');",
      "        \\$cep = new TEntry('cep');",
      "        \\$endereco = new TEntry('endereco');",
      "        \\$funcao_id = new TDBCombo('funcao_id', 'exemplos', 'Funcao', 'id', '{nome}','nome asc');",
      "        \\$habilidades = new TDBMultiSearch('habilidades', 'exemplos', 'Habilidades', 'id', 'nome','nome asc');",
      "",
      "        \\$cidade_estado_pais_id->setChangeAction(new TAction([\\$this,'onChangecidade_estado_pais_id']));",
      "        \\$cidade_estado_id->setChangeAction(new TAction([\\$this,'onChangecidade_estado_id']));",
      "",
      "        \\$dt_nascimento->addValidation(\"Data de nascimento\", new TRequiredValidator());",
      "        \\$nome->addValidation(\"Nome\", new TRequiredValidator());",
      "        \\$sobrenome->addValidation(\"Sobrenome\", new TRequiredValidator());",
      "        \\$cidade_id->addValidation(\"Cidade id\", new TRequiredValidator());",
      "        \\$funcao_id->addValidation(\"Funcao id\", new TRequiredValidator());",
      "",
      "        \\$id->setEditable(false);",
      "        \\$dt_nascimento->setDatabaseMask('yyyy-mm-dd');",
      "        \\$habilidades->setMinLength(2);",
      "        \\$habilidades->setMask('{nome}');",
      "        \\$dt_nascimento->setMask('dd/mm/yyyy');",
      "",
      "        \\$id->setSize(100);",
      "        \\$cep->setSize('100%');",
      "        \\$nome->setSize('100%');",
      "        \\$endereco->setSize('100%');",
      "        \\$sobrenome->setSize('100%');",
      "        \\$cidade_id->setSize('100%');",
      "        \\$funcao_id->setSize('100%');",
      "        \\$dt_nascimento->setSize(110);",
      "        \\$habilidades->setSize('100%', 68);",
      "        \\$cidade_estado_id->setSize('100%');",
      "        \\$cidade_estado_pais_id->setSize('100%');",
      "",
      "        \\$this->form->appendPage(\"Dados pessoais\");",
      "",
      "        \\$this->form->addFields([new THidden('current_tab')]);",
      "        \\$this->form->setTabFunction(\"\\$('[name=current_tab]').val(\\$(this).attr('data-current_page'));\");",
      "",
      "        \\$row1 = \\$this->form->addFields([new TLabel(\"Id:\", null, '14px', null)],[\\$id],[new TLabel(\"Data de nascimento:\", '#ff0000', '14px', null)],[\\$dt_nascimento]);",
      "        \\$row2 = \\$this->form->addFields([new TLabel(\"Nome:\", '#ff0000', '14px', null)],[\\$nome],[new TLabel(\"Sobrenome:\", '#ff0000', '14px', null)],[\\$sobrenome]);",
      "",
      "        \\$this->form->appendPage(\"Endereço\");",
      "        \\$row3 = \\$this->form->addFields([new TLabel(\"País:\", '#ff0000', '14px', null)],[\\$cidade_estado_pais_id],[new TLabel(\"Estado:\", '#ff0000', '14px', null)],[\\$cidade_estado_id]);",
      "        \\$row4 = \\$this->form->addFields([new TLabel(\"Cidade:\", '#ff0000', '14px', null)],[\\$cidade_id],[new TLabel(\"CEP:\", '#ff0000', '14px', null)],[\\$cep]);",
      "        \\$row5 = \\$this->form->addFields([new TLabel(\"Endereco:\", '#ff0000', '14px', null)],[\\$endereco]);",
      "",
      "        \\$this->form->appendPage(\"Capacitação\");",
      "        \\$row6 = \\$this->form->addFields([new TLabel(\"Funcao id:\", '#ff0000', '14px', null)],[\\$funcao_id]);",
      "        \\$row7 = \\$this->form->addFields([new TLabel(\"Habilidades\", null, '14px', null)],[\\$habilidades]);",
      "",
      "        // create the form actions",
      "        \\$btn_onsave = \\$this->form->addAction(\"Salvar\", new TAction([\\$this, 'onSave']), 'far:save #ffffff');",
      "        \\$this->btn_onsave = \\$btn_onsave;",
      "        \\$btn_onsave->addStyleClass('btn-primary');",
      "",
      "        \\$btn_onclear = \\$this->form->addAction(\"Limpar formulário\", new TAction([\\$this, 'onClear']), 'fas:eraser #dd5a43');",
      "        \\$this->btn_onclear = \\$btn_onclear;"
    ],
    "description": "Formulário com abas Adianti",
    "link": "https://www.madbuilder.com.br/exemplo-com-abas"
  }
}</code></pre>
        </div>
      </div>
      <!-- FIM SNIPPET -->
       
      <!-- INÍCIO SNIPPET -->
<div class="snippet-block" data-tags="adianti php form formulario mestre detalhe">
  <div class="snippet-title">
    <i class="fa-solid fa-plus"></i>
    <strong>Formulário Mestre Detalhe Adianti:</strong>
    <a class="download-btn" href="snippets_vscode/adianti_form_mestre_detalhe.code-snippets" download title="Baixar snippet">
      <i class="fa fa-download"></i>
    </a>
  </div>
  <div class="snippet-content">
    <pre><code class="language-json">{
  "Formulário Mestre Detalhe Adianti": {
    "prefix": "adianti_form_mestre_detalhe",
    "body": [
      "class VendaForm extends TPage {",
      "    protected \\$form;",
      "    private \\$formFields = [];",
      "    private static \\$database = 'exemplos';",
      "    private static \\$activeRecord = 'Venda';",
      "    private static \\$primaryKey = 'id';",
      "    private static \\$formName = 'form_Venda';",
      "",
      "    use Adianti\\\\Base\\\\AdiantiMasterDetailTrait;",
      "",
      "    /**",
      "     * Form constructor",
      "     * @param \\$param Request",
      "     */",
      "    public function __construct(\\$param) {",
      "        parent::__construct();",
      "",
      "        if(!empty(\\$param['target_container'])) {",
      "            \\$this->adianti_target_container = \\$param['target_container'];",
      "        }",
      "",
      "        // creates the form",
      "        \\$this->form = new BootstrapFormBuilder(self::\\$formName);",
      "        // define the form title",
      "        \\$this->form->setFormTitle(\"Formulário mestre detalhe\");",
      "",
      "        \\$id = new TEntry('id');",
      "        \\$dt_venda = new TDateTime('dt_venda');",
      "        \\$cliente = new TEntry('cliente');",
      "        \\$vendedor = new TEntry('vendedor');",
      "        \\$venda_item_venda_produto_id = new TDBUniqueSearch('venda_item_venda_produto_id', 'exemplos', 'Produto', 'id', 'nome','id asc');",
      "        \\$venda_item_venda_quantidade = new TNumeric('venda_item_venda_quantidade', '2', ',', '.');",
      "        \\$venda_item_venda_valor = new TNumeric('venda_item_venda_valor', '2', ',', '.');",
      "        \\$venda_item_venda_id = new THidden('venda_item_venda_id');",
      "",
      "        \\$venda_item_venda_produto_id->setChangeAction(new TAction([\\$this,'onChangeProduto']));",
      "",
      "        \\$cliente->addValidation(\"Cliente\", new TRequiredValidator());",
      "",
      "        \\$dt_venda->setDatabaseMask('yyyy-mm-dd hh:ii');",
      "        \\$venda_item_venda_produto_id->setMinLength(1);",
      "        \\$id->setEditable(false);",
      "        \\$venda_item_venda_valor->setEditable(false);",
      "",
      "        \\$dt_venda->setMask('dd/mm/yyyy hh:ii');",
      "        \\$venda_item_venda_produto_id->setMask('{nome}');",
      "",
      "        \\$id->setSize(100);",
      "        \\$dt_venda->setSize(140);",
      "        \\$cliente->setSize('100%');",
      "        \\$vendedor->setSize('100%');",
      "        \\$venda_item_venda_valor->setSize('100%');",
      "        \\$venda_item_venda_produto_id->setSize('100%');",
      "        \\$venda_item_venda_quantidade->setSize('100%');",
      "",
      "        \\$row1 = \\$this->form->addFields([new TLabel(\"Id:\", null, '14px', null)],[\\$id],[new TLabel(\"Data da venda:\", null, '14px', null)],[\\$dt_venda]);",
      "        \\$row2 = \\$this->form->addFields([new TLabel(\"Cliente:\", '#ff0000', '14px', null)],[\\$cliente],[new TLabel(\"Vendedor:\", null, '14px', null)],[\\$vendedor]);",
      "        \\$row3 = \\$this->form->addContent([new TFormSeparator(\"Produtos\", '#333333', '18', '#eeeeee')]);",
      "        \\$row4 = \\$this->form->addFields([new TLabel(\"Produto:\", '#ff0000', '14px', null)],[\\$venda_item_venda_produto_id],[],[]);",
      "        \\$row5 = \\$this->form->addFields([new TLabel(\"Quantidade:\", null, '14px', null)],[\\$venda_item_venda_quantidade],[new TLabel(\"Valor:\", null, '14px', null)],[\\$venda_item_venda_valor]);",
      "        \\$row6 = \\$this->form->addFields([\\$venda_item_venda_id]);",
      "        \\$add_venda_item_venda = new TButton('add_venda_item_venda');",
      "",
      "        \\$action_venda_item_venda = new TAction([\\$this, 'onAddVendaItemVenda']);",
      "",
      "        \\$add_venda_item_venda->setAction(\\$action_venda_item_venda, \"Adicionar\");",
      "        \\$add_venda_item_venda->setImage('fas:plus #000000');",
      "",
      "        \\$this->form->addFields([\\$add_venda_item_venda]);",
      "",
      "        \\$detailDatagrid = new TQuickGrid;",
      "        \\$detailDatagrid->disableHtmlConversion();",
      "        \\$this->venda_item_venda_list = new BootstrapDatagridWrapper(\\$detailDatagrid);",
      "        \\$this->venda_item_venda_list->style = 'width:100%';",
      "        \\$this->venda_item_venda_list->class .= ' table-bordered';",
      "        \\$this->venda_item_venda_list->disableDefaultClick();",
      "        \\$this->venda_item_venda_list->addQuickColumn('', 'edit', 'left', 50);",
      "        \\$this->venda_item_venda_list->addQuickColumn('', 'delete', 'left', 50);",
      "",
      "        \\$column_venda_item_venda_produto_id = \\$this->venda_item_venda_list->addQuickColumn(\"Produto\", 'venda_item_venda_produto_id', 'left');",
      "        \\$column_venda_item_venda_quantidade = \\$this->venda_item_venda_list->addQuickColumn(\"Quantidade\", 'venda_item_venda_quantidade', 'right');",
      "        \\$column_venda_item_venda_valor_transformed = \\$this->venda_item_venda_list->addQuickColumn(\"Valor\", 'venda_item_venda_valor', 'right');",
      "        \\$column_calculated_1 = \\$this->venda_item_venda_list->addQuickColumn(\"Total do item\", '=( {venda_item_venda_quantidade} * {venda_item_venda_valor}  )', 'right');",
      "",
      "        \\$column_calculated_1->setTotalFunction(function(\\$values) {",
      "            return array_sum((array) \\$values);",
      "        });",
      "",
      "        \\$this->venda_item_venda_list->createModel();",
      "        \\$this->form->addContent([\\$this->venda_item_venda_list]);",
      "",
      "        \\$column_venda_item_venda_valor_transformed->setTransformer(function(\\$value, \\$object, \\$row, \\$cell = null, \\$last_row = null) {",
      "            if(!\\$value) {",
      "                \\$value = 0;",
      "            }",
      "",
      "            if(is_numeric(\\$value)) {",
      "                return \"R$ \" . number_format((double)\\$value, 2, \",\", \".\");",
      "            }",
      "            else {",
      "                return \\$value;",
      "            }",
      "        });",
      "",
      "        \\$column_calculated_1->setTransformer(function(\\$value, \\$object, \\$row, \\$cell = null, \\$last_row = null) {",
      "            if(!\\$value) {",
      "                \\$value = 0;",
      "            }",
      "",
      "            if(is_numeric(\\$value)) {",
      "                return \"R$ \" . number_format((double)\\$value, 2, \",\", \".\");",
      "            }",
      "            else {",
      "                return \\$value;",
      "            }",
      "        });",
      "",
      "        // create the form actions",
      "        \\$btn_onsave = \\$this->form->addAction(\"Salvar\", new TAction([\\$this, 'onSave']), 'far:save #ffffff');",
      "        \\$this->btn_onsave = \\$btn_onsave;",
      "        \\$btn_onsave->addStyleClass('btn-primary');",
      "",
      "        \\$btn_onclear = \\$this->form->addAction(\"Limpar formulário\", new TAction([\\$this, 'onClear']), 'fas:eraser #dd5a43');",
      "        \\$this->btn_onclear = \\$btn_onclear;",
      "",
      "        // vertical box container",
      "        \\$container = new TVBox;",
      "        \\$container->style = 'width: 100%';",
      "        \\$container->class = 'form-container';",
      "        if(empty(\\$param['target_container'])) {",
      "            \\$container->add(TBreadCrumb::create([\"Formulários\",\"Mestre detalhe\"]));",
      "        }",
      "        \\$container->add(\\$this->form);",
      "",
      "        parent::add(\\$container);",
      "    }",
      "",
      "    public static function onChangeProduto(\\$param = null) {",
      "        try {",
      "            TTransaction::open('exemplos');",
      "            \\$produto = new Produto(\\$param['key']);",
      "            TTransaction::close();",
      "",
      "            \\$object = new stdClass();",
      "            \\$object->venda_item_venda_valor = number_format((double)\\$produto->preco_venda, 2 , ',', '.');",
      "",
      "            TForm::sendData(self::\\$formName, \\$object);",
      "        }",
      "        catch (Exception \\$e) {",
      "            new TMessage('error', \\$e->getMessage());",
      "        }",
      "    }",
      "",
      "    public function onSave(\\$param = null) {",
      "        try {",
      "            TTransaction::open(self::\\$database); // open a transaction",
      "",
      "            /**",
      "            // Enable Debug logger for SQL operations inside the transaction",
      "            TTransaction::setLogger(new TLoggerSTD); // standard output",
      "            TTransaction::setLogger(new TLoggerTXT('log.txt')); // file",
      "            **/",
      "",
      "            \\$messageAction = null;",
      "",
      "            \\$this->form->validate(); // validate form data",
      "",
      "            \\$object = new Venda(); // create an empty object",
      "",
      "            \\$data = \\$this->form->getData(); // get form data as array",
      "            \\$object->fromArray((array) \\$data); // load the object with data",
      "",
      "            \\$object->store(); // save the object",
      "",
      "            \\$venda_item_venda_items = \\$this->storeItems('VendaItem', 'venda_id', \\$object, 'venda_item_venda', function(\\$masterObject, \\$detailObject) {",
      "                //code here",
      "            });",
      "",
      "            // get the generated {PRIMARY_KEY}",
      "            \\$data->id = \\$object->id;",
      "",
      "            \\$this->form->setData(\\$data); // fill form data",
      "            TTransaction::close(); // close the transaction",
      "",
      "            /**",
      "            // To define an action to be executed on the message close event:",
      "            \\$messageAction = new TAction(['className', 'methodName']);",
      "            **/",
      "",
      "            new TMessage('info', AdiantiCoreTranslator::translate('Record saved'), \\$messageAction);",
      "        }",
      "        catch (Exception \\$e) { // in case of exception",
      "            new TMessage('error', \\$e->getMessage()); // shows the exception error message",
      "            \\$this->form->setData(\\$this->form->getData()); // keep form data",
      "            TTransaction::rollback(); // undo all pending operations",
      "        }",
      "    }",
      "",
      "    public function onEdit(\\$param) {",
      "        try {",
      "            if (isset(\\$param['key'])) {",
      "                \\$key = \\$param['key'];  // get the parameter \\$key",
      "                TTransaction::open(self::\\$database); // open a transaction",
      "",
      "                \\$object = new Venda(\\$key); // instantiates the Active Record",
      "",
      "                \\$venda_item_venda_items = \\$this->loadItems('VendaItem', 'venda_id', \\$object, 'venda_item_venda', function(\\$masterObject, \\$detailObject, \\$objectItems) {",
      "                });",
      "",
      "                \\$this->form->setData(\\$object); // fill the form",
      "",
      "                \\$this->onReload();",
      "",
      "                TTransaction::close(); // close the transaction",
      "            }",
      "            else {",
      "                \\$this->form->clear();",
      "            }",
      "        }",
      "        catch (Exception \\$e) { // in case of exception",
      "            new TMessage('error', \\$e->getMessage()); // shows the exception error message",
      "            TTransaction::rollback(); // undo all pending operations",
      "        }",
      "    }",
      "",
      "    /**",
      "     * Clear form data",
      "     * @param \\$param Request",
      "     */",
      "    public function onClear(\\$param) {",
      "        \\$this->form->clear(true);",
      "",
      "        TSession::setValue('venda_item_venda_items', null);",
      "",
      "        \\$this->onReload();",
      "    }",
      "",
      "    public function onAddVendaItemVenda(\\$param) {",
      "        try {",
      "            \\$data = \\$this->form->getData();",
      "",
      "            if(!\\$data->venda_item_venda_produto_id) {",
      "                throw new Exception(AdiantiCoreTranslator::translate('The field ^1 is required', \"Produto id\"));",
      "            }",
      "",
      "            \\$venda_item_venda_items = TSession::getValue('venda_item_venda_items');",
      "            \\$key = isset(\\$data->venda_item_venda_id) && \\$data->venda_item_venda_id ? \\$data->venda_item_venda_id : 'b'.uniqid();",
      "            \\$fields = [];",
      "",
      "            \\$fields['venda_item_venda_produto_id'] = \\$data->venda_item_venda_produto_id;",
      "            \\$fields['venda_item_venda_quantidade'] = \\$data->venda_item_venda_quantidade;",
      "            \\$fields['venda_item_venda_valor'] = \\$data->venda_item_venda_valor;",
      "            \\$venda_item_venda_items[\\$key] = \\$fields;",
      "",
      "            TSession::setValue('venda_item_venda_items', \\$venda_item_venda_items);",
      "",
      "            \\$data->venda_item_venda_id = '';",
      "            \\$data->venda_item_venda_produto_id = '';",
      "            \\$data->venda_item_venda_quantidade = '';",
      "            \\$data->venda_item_venda_valor = '';",
      "",
      "            \\$this->form->setData(\\$data);",
      "",
      "            \\$this->onReload(\\$param);",
      "        }",
      "        catch (Exception \\$e) {",
      "            \\$this->form->setData(\\$this->form->getData());",
      "",
      "            new TMessage('error', \\$e->getMessage());",
      "        }",
      "    }",
      "",
      "    public function onEditVendaItemVenda(\\$param) {",
      "        \\$data = \\$this->form->getData();",
      "",
      "        // read session items",
      "        \\$items = TSession::getValue('venda_item_venda_items');",
      "",
      "        // get the session item",
      "        \\$item = \\$items[\\$param['venda_item_venda_id_row_id']];",
      "",
      "        \\$data->venda_item_venda_produto_id = \\$item['venda_item_venda_produto_id'];",
      "        \\$data->venda_item_venda_quantidade = \\$item['venda_item_venda_quantidade'];",
      "        \\$data->venda_item_venda_valor = \\$item['venda_item_venda_valor'];",
      "",
      "        \\$data->venda_item_venda_id = \\$param['venda_item_venda_id_row_id'];",
      "",
      "        // fill product fields",
      "        \\$this->form->setData(\\$data);",
      "",
      "        \\$this->onReload(\\$param);",
      "    }",
      "",
      "    public function onDeleteVendaItemVenda(\\$param) {",
      "        \\$data = \\$this->form->getData();",
      "",
      "        \\$data->venda_item_venda_produto_id = '';",
      "        \\$data->venda_item_venda_quantidade = '';",
      "        \\$data->venda_item_venda_valor = '';",
      "",
      "        // clear form data",
      "        \\$this->form->setData(\\$data);",
      "",
      "        // read session items",
      "        \\$items = TSession::getValue('venda_item_venda_items');",
      "",
      "        // delete the item from session",
      "        unset(\\$items[\\$param['venda_item_venda_id_row_id']]);",
      "        TSession::setValue('venda_item_venda_items', \\$items);",
      "",
      "        // reload sale items",
      "        \\$this->onReload(\\$param);",
      "    }",
      "",
      "    public function onReloadVendaItemVenda(\\$param) {",
      "        \\$items = TSession::getValue('venda_item_venda_items');",
      "",
      "        \\$this->venda_item_venda_list->clear();",
      "",
      "        if(\\$items) {",
      "            \\$cont = 1;",
      "            foreach (\\$items as \\$key => \\$item) {",
      "                \\$rowItem = new StdClass;",
      "",
      "                \\$action_del = new TAction([\\$this, 'onDeleteVendaItemVenda']);",
      "                \\$action_del->setParameter('venda_item_venda_id_row_id', \\$key);",
      "                \\$action_del->setParameter('row_data', base64_encode(serialize(\\$item)));",
      "                \\$action_del->setParameter('key', \\$key);",
      "",
      "                \\$action_edi = new TAction([\\$this, 'onEditVendaItemVenda']);",
      "                \\$action_edi->setParameter('venda_item_venda_id_row_id', \\$key);",
      "                \\$action_edi->setParameter('row_data', base64_encode(serialize(\\$item)));",
      "                \\$action_edi->setParameter('key', \\$key);",
      "",
      "                \\$button_del = new TButton('delete_venda_item_venda'.\\$cont);",
      "                \\$button_del->setAction(\\$action_del, '');",
      "                \\$button_del->setFormName(\\$this->form->getName());",
      "                \\$button_del->class = 'btn btn-link btn-sm';",
      "                \\$button_del->title = \"Excluir\";",
      "                \\$button_del->setImage('far:trash-alt #dd5a43');",
      "",
      "                \\$rowItem->delete = \\$button_del;",
      "",
      "                \\$button_edi = new TButton('edit_venda_item_venda'.\\$cont);",
      "                \\$button_edi->setAction(\\$action_edi, '');",
      "                \\$button_edi->setFormName(\\$this->form->getName());",
      "                \\$button_edi->class = 'btn btn-link btn-sm';",
      "                \\$button_edi->title = \"Editar\";",
      "                \\$button_edi->setImage('far:edit #478fca');",
      "",
      "                \\$rowItem->edit = \\$button_edi;",
      "",
      "                \\$rowItem->venda_item_venda_produto_id = '';",
      "                if(isset(\\$item['venda_item_venda_produto_id']) && \\$item['venda_item_venda_produto_id']) {",
      "                    TTransaction::open('exemplos');",
      "                    \\$produto = Produto::find(\\$item['venda_item_venda_produto_id']);",
      "                    if(\\$produto) {",
      "                        \\$rowItem->venda_item_venda_produto_id = \\$produto->render('{nome}');",
      "                    }",
      "                    TTransaction::close();",
      "                }",
      "",
      "                \\$rowItem->venda_item_venda_quantidade = isset(\\$item['venda_item_venda_quantidade']) ? \\$item['venda_item_venda_quantidade'] : '';",
      "                \\$rowItem->venda_item_venda_valor = isset(\\$item['venda_item_venda_valor']) ? \\$item['venda_item_venda_valor'] : '';",
      "",
      "                \\$row = \\$this->venda_item_venda_list->addItem(\\$rowItem);",
      "",
      "                \\$cont++;",
      "            }",
      "        }",
      "    }",
      "",
      "    public function onShow(\\$param = null) {",
      "        TSession::setValue('venda_item_venda_items', null);",
      "        \\$this->onReload();",
      "    }",
      "",
      "    public function onReload(\\$params = null) {",
      "        \\$this->loaded = TRUE;",
      "        \\$this->onReloadVendaItemVenda(\\$params);",
      "    }",
      "",
      "    public function show() {",
      "        if (!\\$this->loaded AND (!isset(\\$_GET['method']) OR \\$_GET['method'] !== 'onReload')) {",
      "            \\$this->onReload(func_get_arg(0));",
      "        }",
      "        parent::show();",
      "    }",
      "}"
    ],
    "description": "Formulário mestre detalhe Adianti",
    "link": "https://www.madbuilder.com.br/exemplo-mestre-detalhe"
  }
}
</code></pre>
  </div>
</div>
<!-- FIM SNIPPET -->

<!-- INÍCIO SNIPPET -->
<div class="snippet-block" data-tags="adianti php form formulario mestre detalhe rotulo acima">
  <div class="snippet-title">
    <i class="fa-solid fa-plus"></i>
    <strong>Formulário Mestre Detalhe Adianti (rótulo acima):</strong>
    <a class="download-btn" href="snippets_vscode/adianti_form_mestre_detalhe_rotulo_acima.code-snippets" download title="Baixar snippet">
      <i class="fa fa-download"></i>
    </a>
  </div>
  <div class="snippet-content">
    <pre><code class="language-json">{
  "Formulário Mestre Detalhe Adianti (rótulo acima)": {
    "prefix": "adianti_form_mestre_detalhe_rotulo_acima",
    "body": [
      "class VendaFormRotulo extends TPage {",
      "    protected \\$form;",
      "    private \\$formFields = [];",
      "    private static \\$database = 'exemplos';",
      "    private static \\$activeRecord = 'Venda';",
      "    private static \\$primaryKey = 'id';",
      "    private static \\$formName = 'form_Venda';",
      "",
      "    use Adianti\\Base\\AdiantiMasterDetailTrait;",
      "",
      "    /**",
      "     * Form constructor",
      "     * @param \\$param Request",
      "     */",
      "    public function __construct(\\$param) {",
      "        parent::__construct();",
      "",
      "        // creates the form",
      "        \\$this->form = new BootstrapFormBuilder(self::\\$formName);",
      "        // define the form title",
      "        \\$this->form->setFormTitle('Mestre detalhe (rótulo acima)');",
      "",
      "        \\$id = new TEntry('id');",
      "        \\$dt_venda = new TDateTime('dt_venda');",
      "        \\$cliente = new TCombo('cliente');",
      "        \\$vendedor = new TCombo('vendedor');",
      "        \\$venda_item_venda_produto_id = new TDBCombo('venda_item_venda_produto_id', 'exemplos', 'Produto', 'id', '{nome}','id asc');",
      "        \\$venda_item_venda_quantidade = new TNumeric('venda_item_venda_quantidade', '2', ',', '.');",
      "        \\$venda_item_venda_valor = new TNumeric('venda_item_venda_valor', '2', ',', '.');",
      "        \\$venda_item_venda_id = new THidden('venda_item_venda_id');",
      "",
      "        \\$venda_item_venda_produto_id->setChangeAction(new TAction([\\$this,'onChangeProduto']));",
      "",
      "        \\$cliente->addValidation('Cliente', new TRequiredValidator());",
      "",
      "        \\$dt_venda->setMask('dd/mm/yyyy hh:ii');",
      "        \\$dt_venda->setDatabaseMask('yyyy-mm-dd hh:ii');",
      "        \\$id->setEditable(false);",
      "        \\$venda_item_venda_valor->setEditable(false);",
      "",
      "        \\$id->setSize(100);",
      "        \\$dt_venda->setSize(140);",
      "        \\$cliente->setSize('71%');",
      "        \\$vendedor->setSize('71%');",
      "        \\$venda_item_venda_valor->setSize('72%');",
      "        \\$venda_item_venda_produto_id->setSize('72%');",
      "        \\$venda_item_venda_quantidade->setSize('72%');",
      "",
      "        \\$cliente->addItems([",
      "            'Artur Comunello' => 'Artur Comunello',",
      "            'João da Silva' => 'João da Silva',",
      "            'Pedro Caetano' => 'Pedro Caetano',",
      "            'Joana Ferreira' => 'Joana Ferreira',",
      "        ]);",
      "",
      "        \\$vendedor->addItems([",
      "            'Patricia Abravanel'=> 'Patricia Abravanel',",
      "            'Carla Cardoso'=> 'Carla Cardoso',",
      "            'Rui Alaemen'=> 'Rui Alaemen',",
      "            'Ivo S. Paula'=> 'Ivo S. Paula',",
      "        ]);",
      "",
      "        \\$row1 = \\$this->form->addFields([new TLabel('Id:', null, '14px', null, '100%'),\\$id],[new TLabel('Data da venda:', null, '14px', null, '100%'),\\$dt_venda]);",
      "        \\$row1->layout = ['col-sm-6','col-sm-6'];",
      "",
      "        \\$row2 = \\$this->form->addFields([new TLabel('Cliente:', '#ff0000', '14px', null, '100%'),\\$cliente],[new TLabel('Vendedor:', null, '14px', null, '100%'),\\$vendedor]);",
      "        \\$row2->layout = ['col-sm-6','col-sm-6'];",
      "",
      "        \\$row3 = \\$this->form->addContent([new TFormSeparator('Produtos', '#333333', '18', '#eeeeee')]);",
      "        \\$row4 = \\$this->form->addFields([new TLabel('Produto:', '#ff0000', '14px', null)],[\\$venda_item_venda_produto_id],[],[]);",
      "        \\$row5 = \\$this->form->addFields([new TLabel('Quantidade:', null, '14px', null)],[\\$venda_item_venda_quantidade],[new TLabel('Valor:', null, '14px', null)],[\\$venda_item_venda_valor]);",
      "        \\$row6 = \\$this->form->addFields([\\$venda_item_venda_id]);",
      "        \\$add_venda_item_venda = new TButton('add_venda_item_venda');",
      "",
      "        \\$action_venda_item_venda = new TAction([\\$this, 'onAddVendaItemVenda']);",
      "",
      "        \\$add_venda_item_venda->setAction(\\$action_venda_item_venda, 'Adicionar');",
      "        \\$add_venda_item_venda->setImage('fas:plus #000000');",
      "",
      "        \\$this->form->addFields([\\$add_venda_item_venda]);",
      "",
      "        \\$this->venda_item_venda_list = new BootstrapDatagridWrapper(new TQuickGrid);",
      "        \\$this->venda_item_venda_list->style = 'min-width:600px;width:100%;';",
      "        \\$this->venda_item_venda_list->class .= ' table-bordered';",
      "        \\$this->venda_item_venda_list->disableDefaultClick();",
      "        \\$this->venda_item_venda_list->addQuickColumn('', 'edit', 'left', 50);",
      "        \\$this->venda_item_venda_list->addQuickColumn('', 'delete', 'left', 50);",
      "",
      "        \\$column_venda_item_venda_produto_id = \\$this->venda_item_venda_list->addQuickColumn('Produto', 'venda_item_venda_produto_id', 'left');",
      "        \\$column_venda_item_venda_quantidade = \\$this->venda_item_venda_list->addQuickColumn('Quantidade', 'venda_item_venda_quantidade', 'right');",
      "        \\$column_venda_item_venda_valor_transformed = \\$this->venda_item_venda_list->addQuickColumn('Valor', 'venda_item_venda_valor', 'right');",
      "        \\$column_calculated_1 = \\$this->venda_item_venda_list->addQuickColumn('Total do item', '=( {venda_item_venda_quantidade} * {venda_item_venda_valor}  )', 'right');",
      "",
      "        \\$column_calculated_1->setTotalFunction(function(\\$values) {",
      "            return array_sum((array) \\$values);",
      "        });",
      "",
      "        \\$this->venda_item_venda_list->createModel();",
      "        \\$div = \\$this->form->addContent([\\$this->venda_item_venda_list]);",
      "        \\$div->class = 'table-responsive';",
      "",
      "        \\$column_venda_item_venda_valor_transformed->setTransformer(function(\\$value, \\$object, \\$row) {",
      "            if(!\\$value) {",
      "                \\$value = 0;",
      "            }",
      "            return \"R$ \" . number_format((double)\\$value, 2, \",\", \".\");",
      "        });",
      "",
      "        \\$column_calculated_1->setTransformer(function(\\$value, \\$object, \\$row) {",
      "            if(!\\$value) {",
      "                \\$value = 0;",
      "            }",
      "            return \"R$ \" . number_format((double)\\$value, 2, \",\", \".\");",
      "        });",
      "",
      "        // create the form actions",
      "        \\$btn_onsave = \\$this->form->addAction('Salvar', new TAction([\\$this, 'onSave']), 'far:save #ffffff');",
      "        \\$btn_onsave->addStyleClass('btn-primary');",
      "",
      "        \\$btn_onclear = \\$this->form->addAction('Limpar formulário', new TAction([\\$this, 'onClear']), 'fas:eraser #dd5a43');",
      "",
      "        // vertical box container",
      "        \\$container = new TVBox;",
      "        \\$container->style = 'width: 100%';",
      "        \\$container->class = 'form-container';",
      "        \\$container->add(\\$this->form);",
      "",
      "        parent::add(\\$container);",
      "    }",
      "",
      "    public static function onChangeProduto(\\$param = null) {",
      "        try {",
      "            //code here",
      "            TTransaction::open('exemplos');",
      "            \\$produto = new Produto(\\$param['key']);",
      "            TTransaction::close();",
      "",
      "            \\$object = new stdClass();",
      "            \\$object->venda_item_venda_valor = number_format((double)\\$produto->preco_venda, 2 , ',', '.');",
      "",
      "            TForm::sendData(self::\\$formName, \\$object);",
      "            //</autoCode>",
      "        }",
      "        catch (Exception \\$e) {",
      "            new TMessage('error', \\$e->getMessage());",
      "        }",
      "    }",
      "",
      "    public function onSave(\\$param = null) {",
      "        try {",
      "            TTransaction::open(self::\\$database); // open a transaction",
      "",
      "            /**",
      "            // Enable Debug logger for SQL operations inside the transaction",
      "            TTransaction::setLogger(new TLoggerSTD); // standard output",
      "            TTransaction::setLogger(new TLoggerTXT('log.txt')); // file",
      "            **/",
      "",
      "            \\$messageAction = null;",
      "",
      "            \\$this->form->validate(); // validate form data",
      "",
      "            \\$object = new Venda(); // create an empty object",
      "",
      "            \\$data = \\$this->form->getData(); // get form data as array",
      "            \\$object->fromArray((array) \\$data); // load the object with data",
      "",
      "            \\$object->store(); // save the object",
      "",
      "            \\$venda_item_venda_items = \\$this->storeItems('VendaItem', 'venda_id', \\$object, 'venda_item_venda', function(\\$masterObject, \\$detailObject) {",
      "                //code here",
      "            });",
      "",
      "            // get the generated {PRIMARY_KEY}",
      "            \\$data->id = \\$object->id;",
      "",
      "            \\$this->form->setData(\\$data); // fill form data",
      "            TTransaction::close(); // close the transaction",
      "",
      "            /**",
      "            // To define an action to be executed on the message close event:",
      "            \\$messageAction = new TAction(['className', 'methodName']);",
      "            **/",
      "",
      "            new TMessage('info', AdiantiCoreTranslator::translate('Record saved'), \\$messageAction);",
      "        }",
      "        catch (Exception \\$e) { // in case of exception",
      "            new TMessage('error', \\$e->getMessage()); // shows the exception error message",
      "            \\$this->form->setData(\\$this->form->getData()); // keep form data",
      "            TTransaction::rollback(); // undo all pending operations",
      "        }",
      "    }",
      "",
      "    public function onEdit(\\$param) {",
      "        try {",
      "            if (isset(\\$param['key'])) {",
      "                \\$key = \\$param['key'];  // get the parameter \\$key",
      "                TTransaction::open(self::\\$database); // open a transaction",
      "",
      "                \\$object = new Venda(\\$key); // instantiates the Active Record",
      "",
      "                \\$venda_item_venda_items = \\$this->loadItems('VendaItem', 'venda_id', \\$object, 'venda_item_venda', function(\\$masterObject, \\$detailObject, \\$objectItems) {",
      "                    //code here",
      "                });",
      "",
      "                \\$this->form->setData(\\$object); // fill the form",
      "",
      "                \\$this->onReload();",
      "",
      "                TTransaction::close(); // close the transaction",
      "            }",
      "            else {",
      "                \\$this->form->clear();",
      "            }",
      "        }",
      "        catch (Exception \\$e) { // in case of exception",
      "            new TMessage('error', \\$e->getMessage()); // shows the exception error message",
      "            TTransaction::rollback(); // undo all pending operations",
      "        }",
      "    }",
      "",
      "    /**",
      "     * Clear form data",
      "     * @param \\$param Request",
      "     */",
      "    public function onClear(\\$param) {",
      "        \\$this->form->clear(true);",
      "",
      "        TSession::setValue('venda_item_venda_items', null);",
      "",
      "        \\$this->onReload();",
      "    }",
      "",
      "    public function onAddVendaItemVenda(\\$param) {",
      "        try {",
      "            \\$data = \\$this->form->getData();",
      "",
      "            if(!\\$data->venda_item_venda_produto_id) {",
      "                throw new Exception(AdiantiCoreTranslator::translate('The field ^1 is required', 'Produto id'));",
      "            }",
      "",
      "            \\$venda_item_venda_items = TSession::getValue('venda_item_venda_items');",
      "            \\$key = isset(\\$data->venda_item_venda_id) && \\$data->venda_item_venda_id ? \\$data->venda_item_venda_id : uniqid();",
      "            \\$fields = [];",
      "",
      "            \\$fields['venda_item_venda_produto_id'] = \\$data->venda_item_venda_produto_id;",
      "            \\$fields['venda_item_venda_quantidade'] = \\$data->venda_item_venda_quantidade;",
      "            \\$fields['venda_item_venda_valor'] = \\$data->venda_item_venda_valor;",
      "            \\$venda_item_venda_items[\\$key] = \\$fields;",
      "",
      "            TSession::setValue('venda_item_venda_items', \\$venda_item_venda_items);",
      "",
      "            \\$data->venda_item_venda_id = '';",
      "            \\$data->venda_item_venda_produto_id = '';",
      "            \\$data->venda_item_venda_quantidade = '';",
      "            \\$data->venda_item_venda_valor = '';",
      "",
      "            \\$this->form->setData(\\$data);",
      "",
      "            \\$this->onReload(\\$param);",
      "        }",
      "        catch (Exception \\$e) {",
      "            \\$this->form->setData(\\$this->form->getData());",
      "",
      "            new TMessage('error', \\$e->getMessage());",
      "        }",
      "    }",
      "",
      "    public function onEditVendaItemVenda(\\$param) {",
      "        \\$data = \\$this->form->getData();",
      "",
      "        // read session items",
      "        \\$items = TSession::getValue('venda_item_venda_items');",
      "",
      "        // get the session item",
      "        \\$item = \\$items[\\$param['venda_item_venda_id_row_id']];",
      "",
      "        \\$data->venda_item_venda_produto_id = \\$item['venda_item_venda_produto_id'];",
      "        \\$data->venda_item_venda_quantidade = \\$item['venda_item_venda_quantidade'];",
      "        \\$data->venda_item_venda_valor = \\$item['venda_item_venda_valor'];",
      "",
      "        \\$data->venda_item_venda_id = \\$param['venda_item_venda_id_row_id'];",
      "",
      "        // fill product fields",
      "        \\$this->form->setData(\\$data);",
      "",
      "        \\$this->onReload(\\$param);",
      "    }",
      "",
      "    public function onDeleteVendaItemVenda(\\$param) {",
      "        \\$data = \\$this->form->getData();",
      "",
      "        \\$data->venda_item_venda_produto_id = '';",
      "        \\$data->venda_item_venda_quantidade = '';",
      "        \\$data->venda_item_venda_valor = '';",
      "",
      "        // clear form data",
      "        \\$this->form->setData(\\$data);",
      "",
      "        // read session items",
      "        \\$items = TSession::getValue('venda_item_venda_items');",
      "",
      "        // delete the item from session",
      "        unset(\\$items[\\$param['venda_item_venda_id_row_id']]);",
      "        TSession::setValue('venda_item_venda_items', \\$items);",
      "",
      "        // reload sale items",
      "        \\$this->onReload(\\$param);",
      "    }",
      "",
      "    public function onReloadVendaItemVenda(\\$param) {",
      "        \\$items = TSession::getValue('venda_item_venda_items');",
      "",
      "        \\$this->venda_item_venda_list->clear();",
      "",
      "        if(\\$items) {",
      "            \\$cont = 1;",
      "            foreach (\\$items as \\$key => \\$item) {",
      "                \\$rowItem = new StdClass;",
      "",
      "                \\$action_del = new TAction([\\$this, 'onDeleteVendaItemVenda']);",
      "                \\$action_del->setParameter('venda_item_venda_id_row_id', \\$key);",
      "",
      "                \\$action_edi = new TAction([\\$this, 'onEditVendaItemVenda']);",
      "                \\$action_edi->setParameter('venda_item_venda_id_row_id', \\$key);",
      "",
      "                \\$button_del = new TButton('delete_venda_item_venda'.\\$cont);",
      "                \\$button_del->class = 'btn btn-default btn-sm';",
      "                \\$button_del->setAction(\\$action_del, '');",
      "                \\$button_del->setImage('far:trash-alt #dd5a43');",
      "                \\$button_del->setFormName(\\$this->form->getName());",
      "",
      "                \\$button_edi = new TButton('edit_venda_item_venda'.\\$cont);",
      "                \\$button_edi->class = 'btn btn-default btn-sm';",
      "                \\$button_edi->setAction(\\$action_edi, '');",
      "                \\$button_edi->setImage('far:edit #478fca');",
      "                \\$button_edi->setFormName(\\$this->form->getName());",
      "",
      "                \\$rowItem->edit = \\$button_edi;",
      "                \\$rowItem->delete = \\$button_del;",
      "",
      "                \\$rowItem->venda_item_venda_produto_id = '';",
      "                if(isset(\\$item['venda_item_venda_produto_id']) && \\$item['venda_item_venda_produto_id']) {",
      "                    TTransaction::open('exemplos');",
      "                    \\$produto = Produto::find(\\$item['venda_item_venda_produto_id']);",
      "                    if(\\$produto) {",
      "                        \\$rowItem->venda_item_venda_produto_id = \\$produto->render('{nome}');",
      "                    }",
      "                    TTransaction::close();",
      "                }",
      "",
      "                \\$rowItem->venda_item_venda_quantidade = isset(\\$item['venda_item_venda_quantidade']) ? \\$item['venda_item_venda_quantidade'] : '';",
      "                \\$rowItem->venda_item_venda_valor = isset(\\$item['venda_item_venda_valor']) ? \\$item['venda_item_venda_valor'] : '';",
      "",
      "                \\$row = \\$this->venda_item_venda_list->addItem(\\$rowItem);",
      "",
      "                \\$cont++;",
      "            }",
      "        }",
      "    }",
      "",
      "    public function onShow(\\$param = null) {",
      "        TSession::setValue('venda_item_venda_items', null);",
      "        \\$this->onReload();",
      "    }",
      "",
      "    public function onReload(\\$params = null) {",
      "        \\$this->loaded = TRUE;",
      "        \\$this->onReloadVendaItemVenda(\\$params);",
      "    }",
      "",
      "    public function show() {",
      "        if (!\\$this->loaded AND (!isset(\\$_GET['method']) OR \\$_GET['method'] !== 'onReload')) {",
      "            \\$this->onReload(func_get_arg(0));",
      "        }",
      "        parent::show();",
      "    }",
      "}"
    ],
    "description": "Formulário Mestre Detalhe Adianti com rótulos acima dos campos",
    "link": "https://www.madbuilder.com.br/exemplo-mestre-detalhe-rotulo-acima"
  }
}
</code></pre>
  </div>
</div>
<!-- FIM SNIPPET -->

<!-- INÍCIO SNIPPET -->
<div class="snippet-block" data-tags="adianti php form formulario parcelas botao">
  <div class="snippet-title">
    <i class="fa-solid fa-plus"></i>
    <strong>Formulário Adianti conta com geração automática de parcelas:</strong>
    <a class="download-btn" href="snippets_vscode/adianti_form_gerar_parcelas_com_botao.code-snippets" download title="Baixar snippet">
      <i class="fa fa-download"></i>
    </a>
  </div>
  <div class="snippet-content">
    <pre><code class="language-json">{
  "Formulário Adianti conta com geração automática de parcelas": {
    "prefix": "adianti_form_conta_parcelas",
    "body": [
      "class ContaDetalheForm extends TPage {",
      "    protected \\$form;",
      "    private \\$formFields = [];",
      "    private static \\$database = 'exemplos';",
      "    private static \\$activeRecord = 'Conta';",
      "    private static \\$primaryKey = 'id';",
      "    private static \\$formName = 'form_Conta';",
      "",
      "    use Adianti\\\\Base\\\\AdiantiMasterDetailTrait;",
      "",
      "    /**",
      "     * Form constructor",
      "     * @param \\$param Request",
      "     */",
      "    public function __construct(\\$param) {",
      "        parent::__construct();",
      "",
      "        if(!empty(\\$param['target_container'])) {",
      "            \\$this->adianti_target_container = \\$param['target_container'];",
      "        }",
      "",
      "        // creates the form",
      "        \\$this->form = new BootstrapFormBuilder(self::\\$formName);",
      "        // define the form title",
      "        \\$this->form->setFormTitle(\"Gerar registros de detalhe automaticamente\");",
      "",
      "        \\$id = new TEntry('id');",
      "        \\$valor = new TEntry('valor');",
      "        \\$parcelas = new TEntry('parcelas');",
      "        \\$dt_vencimento = new TDate('dt_vencimento');",
      "        \\$button_gerar_parcelas = new TButton('button_gerar_parcelas');",
      "        \\$parcela_conta_valor = new TEntry('parcela_conta_valor');",
      "        \\$parcela_conta_num_parcela = new TEntry('parcela_conta_num_parcela');",
      "        \\$parcela_conta_dt_vencimento = new TDate('parcela_conta_dt_vencimento');",
      "        \\$parcela_conta_id = new THidden('parcela_conta_id');",
      "",
      "        \\$id->setEditable(false);",
      "        \\$button_gerar_parcelas->setAction(new TAction([\\$this, 'gerarParcelas']), \"Gerar parcelas\");",
      "        \\$button_gerar_parcelas->addStyleClass('btn-success');",
      "        \\$button_gerar_parcelas->setImage('far:money-bill-alt #ffffff');",
      "        \\$dt_vencimento->setMask('dd/mm/yyyy');",
      "        \\$parcela_conta_dt_vencimento->setMask('dd/mm/yyyy');",
      "",
      "        \\$dt_vencimento->setDatabaseMask('yyyy-mm-dd');",
      "        \\$parcela_conta_dt_vencimento->setDatabaseMask('yyyy-mm-dd');",
      "",
      "        \\$id->setSize(100);",
      "        \\$valor->setSize('70%');",
      "        \\$parcelas->setSize('70%');",
      "        \\$dt_vencimento->setSize(110);",
      "        \\$parcela_conta_valor->setSize('70%');",
      "        \\$parcela_conta_num_parcela->setSize('70%');",
      "        \\$parcela_conta_dt_vencimento->setSize(110);",
      "",
      "        \\$row1 = \\$this->form->addFields([new TLabel(\"Id:\", null, '14px', null)],[\\$id]);",
      "        \\$row2 = \\$this->form->addFields([new TLabel(\"Valor:\", null, '14px', null)],[\\$valor]);",
      "        \\$row3 = \\$this->form->addFields([new TLabel(\"Parcelas:\", null, '14px', null)],[\\$parcelas]);",
      "        \\$row4 = \\$this->form->addFields([new TLabel(\"Data de vencimento\", null, '14px', null)],[\\$dt_vencimento,\\$button_gerar_parcelas]);",
      "        \\$row5 = \\$this->form->addContent([new TFormSeparator(\"Parcelas\", '#333333', '18', '#eeeeee')]);",
      "        \\$row6 = \\$this->form->addFields([new TLabel(\"Valor:\", null, '14px', null)],[\\$parcela_conta_valor]);",
      "        \\$row7 = \\$this->form->addFields([new TLabel(\"Num parcela:\", null, '14px', null)],[\\$parcela_conta_num_parcela]);",
      "        \\$row8 = \\$this->form->addFields([new TLabel(\"Dt vencimento:\", null, '14px', null)],[\\$parcela_conta_dt_vencimento]);",
      "        \\$row9 = \\$this->form->addFields([\\$parcela_conta_id]);",
      "        \\$add_parcela_conta = new TButton('add_parcela_conta');",
      "",
      "        \\$action_parcela_conta = new TAction([\\$this, 'onAddParcelaConta']);",
      "",
      "        \\$add_parcela_conta->setAction(\\$action_parcela_conta, \"Adicionar\");",
      "        \\$add_parcela_conta->setImage('fas:plus #000000');",
      "",
      "        \\$this->form->addFields([\\$add_parcela_conta]);",
      "",
      "        \\$detailDatagrid = new TQuickGrid;",
      "        \\$detailDatagrid->disableHtmlConversion();",
      "        \\$this->parcela_conta_list = new BootstrapDatagridWrapper(\\$detailDatagrid);",
      "        \\$this->parcela_conta_list->style = 'width:100%';",
      "        \\$this->parcela_conta_list->class .= ' table-bordered';",
      "        \\$this->parcela_conta_list->disableDefaultClick();",
      "        \\$this->parcela_conta_list->addQuickColumn('', 'edit', 'left', 50);",
      "        \\$this->parcela_conta_list->addQuickColumn('', 'delete', 'left', 50);",
      "",
      "        \\$column_parcela_conta_valor_transformed = \\$this->parcela_conta_list->addQuickColumn(\"Valor\", 'parcela_conta_valor', 'left');",
      "        \\$column_parcela_conta_num_parcela = \\$this->parcela_conta_list->addQuickColumn(\"Número parcela\", 'parcela_conta_num_parcela', 'left');",
      "        \\$column_parcela_conta_dt_vencimento = \\$this->parcela_conta_list->addQuickColumn(\"Data de vencimento\", 'parcela_conta_dt_vencimento', 'left');",
      "",
      "        \\$this->parcela_conta_list->createModel();",
      "        \\$this->form->addContent([\\$this->parcela_conta_list]);",
      "",
      "        \\$column_parcela_conta_valor_transformed->setTransformer(function(\\$value, \\$object, \\$row, \\$cell = null, \\$last_row = null) {",
      "            if(!\\$value) {",
      "                \\$value = 0;",
      "            }",
      "",
      "            if(is_numeric(\\$value)) {",
      "                return \"R$ \" . number_format((double)\\$value, 2, \",\", \".\");",
      "            }",
      "            else {",
      "                return \\$value;",
      "            }",
      "        });",
      "",
      "        // create the form actions",
      "        \\$btn_onsave = \\$this->form->addAction(\"Salvar\", new TAction([\\$this, 'onSave']), 'far:save #ffffff');",
      "        \\$this->btn_onsave = \\$btn_onsave;",
      "        \\$btn_onsave->addStyleClass('btn-primary');",
      "",
      "        \\$btn_onclear = \\$this->form->addAction(\"Limpar formulário\", new TAction([\\$this, 'onClear']), 'fas:eraser #dd5a43');",
      "        \\$this->btn_onclear = \\$btn_onclear;",
      "",
      "        // vertical box container",
      "        \\$container = new TVBox;",
      "        \\$container->style = 'width: 100%';",
      "        \\$container->class = 'form-container';",
      "        if(empty(\\$param['target_container'])) {",
      "            \\$container->add(TBreadCrumb::create([\"Formulários\",\"Gerar registros em detalhe dinamicamente por um botão no formulário\"]));",
      "        }",
      "        \\$container->add(\\$this->form);",
      "",
      "        parent::add(\\$container);",
      "    }",
      "    // ...restante do código omitido para brevidade..."
    ],
    "description": "Formulário de Conta com geração automática de parcelas com botão de geração dinâmica",
    "link": "https://www.madbuilder.com.br/exemplo-gerar-registros-em-detalhe-dinamicamente-por-um-botao-no-formulario"
  }
}
</code></pre>
  </div>
</div>
<!-- FIM SNIPPET -->

<!-- INÍCIO SNIPPET -->
<div class="snippet-block" data-tags="adianti php form formulario tdbcombo dinamico">
  <div class="snippet-title">
    <i class="fa-solid fa-plus"></i>
    <strong>Preencimento dinâmico de TDBCombo Adianti:</strong>
    <a class="download-btn" href="snippets_vscode/adianti_form_tdbcombo_dinamico.code-snippets" download title="Baixar snippet">
      <i class="fa fa-download"></i>
    </a>
  </div>
  <div class="snippet-content">
    <pre><code class="language-json">{
  "Preencimento dinâmico de TDBCombo Adianti": {
    "prefix": "adianti_form_tdbcombo_condicional",
    "body": [
      "class CidadeForm extends TPage {",
      "    protected $form;",
      "    private $formFields = [];",
      "    private static $database = 'exemplos';",
      "    private static $activeRecord = 'Cidade';",
      "    private static $primaryKey = 'id';",
      "    private static $formName = 'form_Cidade';",
      "",
      "    public function __construct($param) {",
      "        parent::__construct();",
      "",
      "        if (!empty($param['target_container'])) {",
      "            $this->adianti_target_container = $param['target_container'];",
      "        }",
      "",
      "        $this->form = new BootstrapFormBuilder(self::$formName);",
      "        $this->form->setFormTitle(\"Ação na saída do campo\");",
      "",
      "        $estado_pais_id = new TDBCombo('estado_pais_id', 'exemplos', 'Pais', 'id', '{nome}','nome asc');",
      "        $estado_id = new TCombo('estado_id');",
      "        $cidade_id = new TCombo('cidade_id');",
      "",
      "        $estado_pais_id->setChangeAction(new TAction([$this,'onChangeestado_pais_id']));",
      "        $estado_id->setChangeAction(new TAction([$this,'onChangeestado_id']));",
      "",
      "        $estado_id->addValidation(\"Estado id\", new TRequiredValidator());",
      "        $cidade_id->addValidation(\"Nome\", new TRequiredValidator());",
      "",
      "        $estado_id->setSize('70%');",
      "        $cidade_id->setSize('70%');",
      "        $estado_pais_id->setSize('70%');",
      "",
      "        $estado_id->enableSearch();",
      "        $cidade_id->enableSearch();",
      "        $estado_pais_id->enableSearch();",
      "",
      "        $this->form->addFields([new TLabel(\"País:\", '#ff0000', '14px', null)],[$estado_pais_id]);",
      "        $this->form->addFields([new TLabel(\"Estado:\", '#ff0000', '14px', null)],[$estado_id]);",
      "        $this->form->addFields([new TLabel(\"Cidade:\", '#ff0000', '14px', null)],[$cidade_id]);",
      "",
      "        $btn_onsave = $this->form->addAction(\"Salvar\", new TAction([$this, 'onSave']), 'far:save #ffffff');",
      "        $this->btn_onsave = $btn_onsave;",
      "        $btn_onsave->addStyleClass('btn-primary');",
      "",
      "        $btn_onclear = $this->form->addAction(\"Limpar formulário\", new TAction([$this, 'onClear']), 'fas:eraser #dd5a43');",
      "        $this->btn_onclear = $btn_onclear;",
      "",
      "        $container = new TVBox;",
      "        $container->style = 'width: 100%';",
      "        $container->class = 'form-container';",
      "",
      "        if (empty($param['target_container'])) {",
      "            $container->add(TBreadCrumb::create([\"Formulários\",\"Preencher campo na saída\"]));",
      "        }",
      "",
      "        $container->add($this->form);",
      "        parent::add($container);",
      "    }",
      "",
      "    public static function onChangeestado_pais_id($param) {",
      "        try {",
      "            if (isset($param['estado_pais_id']) && $param['estado_pais_id']) {",
      "                $criteria = TCriteria::create(['pais_id' => $param['estado_pais_id']]);",
      "                TDBCombo::reloadFromModel(self::$formName, 'estado_id', 'exemplos', 'Estado', 'id', '{nome}', 'nome asc', $criteria, TRUE);",
      "            } else {",
      "                TCombo::clearField(self::$formName, 'estado_id');",
      "            }",
      "        } catch (Exception $e) {",
      "            new TMessage('error', $e->getMessage());",
      "        }",
      "    }",
      "",
      "    public static function onChangeestado_id($param) {",
      "        try {",
      "            if (isset($param['estado_id']) && $param['estado_id']) {",
      "                $criteria = TCriteria::create(['estado_id' => $param['estado_id']]);",
      "                TDBCombo::reloadFromModel(self::$formName, 'cidade_id', 'exemplos', 'Cidade', 'id', '{nome}', 'nome asc', $criteria, TRUE);",
      "            } else {",
      "                TCombo::clearField(self::$formName, 'cidade_id');",
      "            }",
      "        } catch (Exception $e) {",
      "            new TMessage('error', $e->getMessage());",
      "        }",
      "    }",
      "",
      "    public function onSave($param = null) {",
      "        try {",
      "            new TMessage('info', 'Dados selecionados:<br>' . json_encode($param));",
      "            TScript::create(\"",
      "            setTimeout(function(){",
      "                $('.sweet-alert').find('p').css('word-wrap', 'break-word')",
      "            }, 400);",
      "            \");",
      "            return;",
      "",
      "            TTransaction::open(self::$database);",
      "            $this->form->validate();",
      "",
      "            $object = new Cidade();",
      "            $data = $this->form->getData();",
      "            $object->fromArray((array) $data);",
      "            $object->store();",
      "            $this->fireEvents($object);",
      "",
      "            $data->id = $object->id;",
      "            $this->form->setData($data);",
      "            TTransaction::close();",
      "",
      "            new TMessage('info', AdiantiCoreTranslator::translate('Record saved'));",
      "        } catch (Exception $e) {",
      "            new TMessage('error', $e->getMessage());",
      "            $this->form->setData($this->form->getData());",
      "            TTransaction::rollback();",
      "        }",
      "    }",
      "",
      "    public function onEdit($param) {",
      "        try {",
      "            if (isset($param['key'])) {",
      "                $key = $param['key'];",
      "                TTransaction::open(self::$database);",
      "                $object = new Cidade($key);",
      "                $object->estado_pais_id = $object->estado->pais->id;",
      "                $this->form->setData($object);",
      "                $this->fireEvents($object);",
      "                TTransaction::close();",
      "            } else {",
      "                $this->form->clear();",
      "            }",
      "        } catch (Exception $e) {",
      "            new TMessage('error', $e->getMessage());",
      "            TTransaction::rollback();",
      "        }",
      "    }",
      "",
      "    public function onClear($param) {",
      "        $this->form->clear(true);",
      "    }",
      "",
      "    public function onShow($param = null) {",
      "    }",
      "",
      "    public function fireEvents($object) {",
      "        $obj = new stdClass;",
      "        if (is_object($object) && get_class($object) == 'stdClass') {",
      "            if (isset($object->estado_pais_id)) { $obj->estado_pais_id = $object->estado_pais_id; }",
      "            if (isset($object->estado_id)) { $obj->estado_id = $object->estado_id; }",
      "            if (isset($object->cidade_id)) { $obj->cidade_id = $object->cidade_id; }",
      "        } elseif (is_object($object)) {",
      "            if (isset($object->estado->pais->id)) { $obj->estado_pais_id = $object->estado->pais->id; }",
      "            if (isset($object->estado_id)) { $obj->estado_id = $object->estado_id; }",
      "            if (isset($object->cidade_id)) { $obj->cidade_id = $object->cidade_id; }",
      "        }",
      "        TForm::sendData(self::$formName, $obj);",
      "    }",
      "}"
    ],
    "description": "Preencimento dinâmico de TDBCombo Adianti",
    "link": "https://www.madbuilder.com.br/exemplo-preencher-campo-na-saida"
  }
}
</code></pre>
  </div>
</div>
<!-- FIM SNIPPET -->

    </div>
  </div>
</div>